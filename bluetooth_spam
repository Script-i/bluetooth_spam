#include <M5StickC.h>
#include <BluetoothSerial.h>

BluetoothSerial SerialBT;

// Nome do dispositivo que será spoofed  
const char* deviceName = "Apple Watch"; // Nome do dispositivo que será apresentado  
int victimCount = ; // Contador de vítimas

void setup() {
    // Inicializa o M5StickC  
    M5.begin();
    Serial.begin(115200);

    // Inicializa o Bluetooth  
    SerialBT.begin(deviceName);
    Serial.println("Bluetooth iniciado. Nome do dispositivo: " + String(deviceName));
}

void loop() {
    // Verifica se há novos clientes Bluetooth  
    if (SerialBT.hasClient()) {
        victimCount++; // Incrementa o contador de vítimas

        // Mostra o número de vítimas na tela do M5StickC  
        M5.Lcd.fillScreen(BLACK);
        M5.Lcd.setTextColor(WHITE);
        M5.Lcd.setTextSize(2);
        M5.Lcd.setCursor(10, 10);
        M5.Lcd.printf("Vítimas: %d", victimCount);
        
        // Aguarda um tempo para evitar múltiplas contagens  
        delay(500); // Aguarda 5 segundos antes de verificar novamente  
    }
    
    // Simulação de um pedido de conexão  
    Serial.println("Aguardando conexão...");
    delay(100); // Aguarda 1 segundo antes de verificar novamente  
}
